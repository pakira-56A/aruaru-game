# [あるある神経衰弱：界隈探求ゲーム](https://aruaru-games.com/)
- 補足：このサービスを詳しく解説した Qiita記事も公開しています！
  - [【個人開発】**様々な界隈のあるあるを神経衰弱で遊び、Xで交流するサービス**を作りました！](https://qiita.com/pakira-56A/items/8fde551e0e14520d6f3c)  
    <img src="https://i.gyazo.com/f974550f90299f41f0773b6c31fc3db3.png" alt="Image from Gyazo" width="650"/>  

以下に詳しく機能ごとの動画を貼ってますが
## [こちらのリンクは`当サービスの全体の操作の流れ`を撮影したもの](https://drive.google.com/file/d/1ANewasmQ9Rs_Pi6g4G_ywwmX-Y41VhOE/preview)です
- 遊んでいただいた皆様の感想はこちら → [#あるある神経衰弱](https://x.com/search?q=%23あるある神経衰弱&src=recent_search_click&f=live)  
  <img src="https://i.gyazo.com/5bd973d301675701dce8180b5685a712.gif" alt="Image from Gyazo" width="500"/>

# ■ サービス概要
- ユーザーが投稿した`界隈あるある`５つを印字したカードで、神経衰弱として遊べる
- ユーザーは、ゆかりのある界隈のあるあるを投稿・シェアできる
  - シェアし合うことで、SNS上(Xなど)のあらゆるカルチャーのユーザーとも交流ができる
- 投稿された`界隈`とゆかりがある/なしに関わらず、メジャーから超ニッチまで・あらゆるカルチャーを遊んで知れる
- 共通の趣味・話題がない間柄でも、互いを知り・深く交流できるようサポートします

『`界隈のあるある`を、神経衰弱で遊ぶ』とはどういうことか、イメージしづらいかと思います。  
以下が、『投稿された`コナンくん映画`という界隈のあるあるを、神経衰弱で遊ぶ』様子です！🃏

<img src="https://i.gyazo.com/892f21e7ada508929638e838cc00d8f4.gif" alt="Image from Gyazo" width="500"/>

____

# ■ このサービスへの思い・作った理由
**コミュニケーションツールとして**

- 開発者の私自身　趣味が多い方ですが、それでも趣味が共通しない方はまだまだいらっしゃいます。  
  **「○○さんと仲良くなりたいけど、話せる共通の趣味や話題がない...😖」** という時、上辺だけの会話になりがちですよね。
- 「どんなものやカルチャーが好きで」「物事をどんな捉え方をする人物なのか」「なぜそのカルチャーはそんな`あるある`が発生するのか」  
  お互いの**パーソナルな情報**・**オタクみを交換/認識**して遊べるようなゲームがあれば  
  共通の趣味や話題がなくても、コミュニケーションを取りやすいのではと考え開発しました。
- 例えば！！！
  - 新しいクラスメイト、新入社員と同僚、最近通い始めた美容師さん、気になるあの子...🤫  
   「初めまして」のコミュニケーションツールになって欲しいです！
  - もちろん、既に仲良し同士さんでも「君にそんな界隈に属す一面が！？」なんて発見になります
  - 神経衰弱が苦手なユーザーでも、ただ「めくってあるあるを知る」という奇妙な体験ができます

**開発者の個人的な願望**
- 開発者は、ラジオで不特定多数の趣味・趣向の話を聴くのが楽しくて好きです  
 まだまだ知り得ない界隈や、想像もつかない`あるある`が溢れかえってると思います  
 個人的に、その`界隈あるある`をもっと知りたいと思ったからです  
- そして、その`あるある`はどのような経緯で発生するものなのか、考察したり・お話を聞けると楽しいだろうなと思ったからです
______
# ■ ユーザーの獲得について
- Xシェア時にハッシュタグ・[#あるある神経衰弱](https://x.com/hashtag/%E3%81%82%E3%82%8B%E3%81%82%E3%82%8B%E7%A5%9E%E7%B5%8C%E8%A1%B0%E5%BC%B1?src=hashtag_click&f=live) を活用する
- プレイした界隈をハッシュタグとして活用する  
  - 例：`ONE PIECE`という界隈名で投稿・Xシェアされた場合は、Xのポストに`#ONEPIECE`を含ませる
- 動的OGPを採用（興味を持ってもらうため、神経衰弱のカードにモザイクをかけてます）  
  <img src="https://i.gyazo.com/7eb7cdeb519754bc16deca5592d445dd.png" alt="Image from Gyazo" width="530"/>

# ■ サービスの差別化ポイント
`あるある`を使ったゲームは沢山ありますが、`誰もが共感できる無難なテーマ(界隈)`が決まってるものが多いです（小学生あるある・恋愛あるあるなど）  
　
当サービスの特徴は・・・
- ユーザーが投稿するので、**メジャー/ニッチを問わず どんな界隈でも遊べる！**
- さらに、**ゆかりのない`界隈のあるある`を知れる・シェアできる！！！**（例：作品や業種の界隈など）
- コミュニケーションツールは沢山あるが、よりパーソナルな部分（特にオタクみ）に焦点を当てている
- いつでも、どこでも、すぐに遊べる（AIで生成した`界隈あるある`で遊ぶ場合は１ブラウザ１日１回）
  
# ■ サービスの推しポイント
- ユーザビリティ重視
  - 暇な時にもゴロゴロしながら遊んで欲しいので、レスポンシブはスマホ重視
- レイアウトやデザインのコンセプトは
  `シンプル` `POPに` `文字の少ない説明で明確に` `アイコンの配置で導線を明確に`
- ログイン状態によって必要なボタンを表示するなどし、**操作の導線を明確にした**
  - ログイン済みなら`投稿しよう！ボタン`を、未ログインなら`ログインして投稿しよう！ボタン`を表示して誘導
    <img src="https://i.gyazo.com/73be1e99f22a78fb4418dd82a2ed2011.png" alt="Image from Gyazo" width="480"/>
    
- ワクワクしてもらいたいので、リンクのホバー時の変化を大きくしました
  <img src="https://i.gyazo.com/3f98f36d4874f175b24e12748de4bcd3.gif" alt="Image from Gyazo" width="500"/>

- ユーザー情報や投稿などの**詳細画面**など、煩わしい画面遷移を設けませんでした
  <img src="https://i.gyazo.com/a2816043cf67113651be80bd05a282d4.gif" alt="Image from Gyazo" width="500"/>

- その他にも、まだまだ`楽しめる演出`や`無駄を省いたこと`や`AI🤖で界隈あるあるを生成できる機能`など  
  推しポイントはまだまだあるのですが、READMEには書ききれないので 以下のQiita記事で解説しています！
  - [【個人開発】様々な界隈のあるあるを神経衰弱で遊び、Xで交流するサービスを作りました | 推しポイント](https://qiita.com/pakira-56A/items/8fde551e0e14520d6f3c#5-2-%E6%8E%A8%E3%81%97%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88)

## 当サービスにおける神経衰弱カードの特徴  
当サービスで使うトランプカードの表面（めくった後に表示される面）には  
`ユーザーが投稿したあるある５つ` or `AIで生成したあるある5つ`の**文字列**が表示されます！

- ニッチな内容も投稿して欲しいので、`界隈名`と`あるある`はそれぞれ40文字まで
- カードがペアになると、**ペア同士で文字の色が変化します**  
  <img src="https://i.gyazo.com/6f10e83bd5f3856612f8094b19b31560.gif" alt="Image from Gyazo" width="400"/>
  <img src="https://i.gyazo.com/6dceded7d313a601af37eb3b6deffbf2.png" alt="Image from Gyazo" width="270"/>

# ■ セキュリティ面
- **Cookieを使ったセッション機能**🍪  
  AIであるあるを生成するのは、Open AIを使います。  
  ただ、回数制限を超えて使えなくなる事態を回避したいので、当サービスでは`1ユーザー1日1回`という設定を設けました。  
  - AI生成機能を使ったブラウザではCookieを取得させ、その日付で「今日はもう生成済みか」を判別させました。  
    
    <details><summary>補足：なぜCookieセッションを選んだのか</summary>

    **「今日はもう生成済みか」を判別する手段として、なぜCookieセッションを選んだのか**  
    　
    - データベースのストレージ容量が圧迫するリスクがあるので、AIで生成した投稿をデータベースに保存させない事にしました。  
    - そして、キャッシュを使って判別する方法を模索し  
      **ブラウザのタブを行き来しても、キャッシュを反映させたかった**のでCookieセッションを採用しました。  
    
      ```ruby
      # cookieに保存
      Time.zone = "Tokyo"
      cookies[:cookie取得名] = { 
          value: Time.zone.today.to_s,     # 日本時間で
          expires: Time.zone.now + 1.day,  # 1日後に期限切れ
          secure: Rails.env.production?,   # 本番環境で動いているときだけクッキーはHTTPSを使って配送され、クッキーが盗まれるリスクを減らす
          httponly: true,   # XSS対策
          same_site: :lax   # CSRF対策
          }
      ```

    - **`httponly: true`**（XSS対策）  
      **JavaScriptからそのクッキーにアクセスできなくり、XSS攻撃でクッキーが盗まれにくくなる記載。**  
      ユーザーに与えたCookieの情報は、当サービスでは`その日付か否かの判別`にしか使いません。  
      JavaScriptでCookieの情報を取得したりする機能は実装していませんし、実装予定もないので記載しました。  

 
    - **`same_site: :lax`**（CSRF対策）  
      **クロスサイトリクエストフォージェリ（CSRF）攻撃を防ぐ記載。**  
      ユーザーがリンクをクリックしたり、他サイトからのGETリクエストを通じて、意図しない操作を実行されるリスクを減らせます。  
        
        </details>

　
- **IDを含むURLのエラーハンドリング**  
  存在しないURLや、存在しないIDが含まれるURLにアクセスした際は、メッセージを表示させています  
  - **なぜメッセージなのか？**  
    404ページに遷移すると、当サービスの存在するURLにブラウザバックする手間が発生します。  
    なので、投稿一覧に遷移しメッセージで処理し、**引き続き 投稿で遊んでもらうため**です。  
    （以下は現在存在しないID:1000が含まれる`https://ドメイン/games/1000/start`というURLで検証した動画です）  
    <img src="https://i.gyazo.com/5fd44b49ee1a3542fa5480815eb90f3c.gif" alt="Image from Gyazo" width="1000"/>


# ■ 使用方法
### メイン機能
|`界隈あるある`を、投稿（ログイン必須） | `界隈あるある`を、AIで生成 |
|:-----------:|:------------:|
| <img src="https://i.gyazo.com/29a22c4fa690fe35bea623e6ba9db7b3.gif" alt="Image from Gyazo" width="250"/> | <img src="https://i.gyazo.com/5883f9998ac62037dd9fbe2a70bcfdbb.gif" alt="Image from Gyazo" width="250"/> |
|　ユーザーは好きな界隈のあるあるを投稿できます（文字数カウンター付き） | AIに界隈名を送信すると、あるあるが生成され神経衰弱で遊べます　|

| `界隈あるある`を、神経衰弱で遊ぶ | ゲームクリア後、交流や投稿を誘導 |
|:-----------:|:------------:|
| <img src="https://i.gyazo.com/a941cbc143757cbeb471ae2d742ca34c.gif" alt="Image from Gyazo" width="250"/> | <img src="https://i.gyazo.com/73be1e99f22a78fb4418dd82a2ed2011.png" alt="Image from Gyazo" width="480"/> |
|　ペアを作りながら`あるある`を知ることができます | Xに遷移し`感想`をポスト・閲覧できることを提示（ユーザーのログイン状態によって誘導が変化）|

|`界隈あるある`をXシェア（動的OGP） | Xで`界隈あるある`の感想を閲覧できる |
|:-----------:|:------------:|
| <img src="https://i.gyazo.com/d50a738f9f45d75a10f98067a450517b.gif" alt="Image from Gyazo" width="250"/> |<img src="https://i.gyazo.com/cf356fd03fef4a530501cc2d670d11ac.gif" alt="Image from Gyazo" width="250"/>|
|　界隈名がX上でハッシュタグ化し、動的OGPが表示されます | 他ユーザーがシェアした感想をXで閲覧・交流ができる |

### サブ機能
| 投稿された`界隈`を、タグで絞り込み | 検索 |検索（ヒットしない場合）|
|:-----------:|:------------:|:------------:|
| <img src="https://i.gyazo.com/c631388adb5ed9066e82a318b439e55c.gif" alt="Image from Gyazo" width="250"/> |<img src="https://i.gyazo.com/611e1f54f8062f1d65a1549c2c6981e8.gif" alt="Image from Gyazo" width="250"/>|<img src="https://i.gyazo.com/3337c830b4cda69e58d015c49adbd65d.gif" alt="Image from Gyazo" width="250"/>|
| 投稿されたタグから、近い界隈を検索できます | 界隈名を直接検索できます（オートコンプリート付き）|検索結果がヒットしない場合は新規投稿を促します |

| 自作したあるある一覧・設定（ログイン必須） | お気に入り機能（ログイン必須） |
|:-:|:-:|
| <img src="https://i.gyazo.com/d540bd47616785b1fc7deac3adf99c58.gif" alt="Image from Gyazo" width="250"/> | <img src="https://i.gyazo.com/7a1f29b6c12a27ae30a56b57a7c6dafc.gif" alt="Image from Gyazo" width="250"/> |
| ログインしたユーザー名と、投稿した`界隈あるある`を確認し遊べます | 誰かが投稿した`界隈あるある`をお気に入り登録し、再び遊びやすくなります |

___
# ■ 機能一覧

### MVPリリースに向け機能
- Google認証ログイン・ログアウトができる
- 界隈あるあるを投稿・編集・削除できる
- 投稿された界隈あるあるを、神経衰弱で遊べる
　　
### 本リリースに向け機能
- ユーザー名を変更できる
- 界隈名を検索（オートコンプリート付き）
- 界隈をお気に入り登録・解除
- 界隈にタグをつけ・タグで絞り込み検索ができる
- Xシェア
- 動的OGP
- AIで界隈あるあるを生成し、神経衰弱で遊べる
  - この機能を実装する理由
    - いきなり界隈あるあるを投稿するのはハードルが高いので、一旦AIが生成した神経衰弱で遊び方を把握してもらうため
    - 「AIがどんな`あるある`を生み出すのか」と疑問を生み`あるある`というものに興味を持ってもらうため
    - どんな界隈を入力しても何かしらは返ってきますが`ないない`も混ざっているので、ユーザーに「自分の方が面白いあるあるが有る！」と思って投稿してもらうため
- セキュリティなど
  - 存在しないURLに対するエラーハンドリング(IDを含むもの・その他)
  - Cokkieを使ったセッション機能
  - CSRF対策
  - XSS対策
  - GitHub Actionsによるテスト自動化(RSpec・RuboCop)
  - スリープ対策に[Uptime Robot](https://uptimerobot.com/)を活用
  - お問い合わせフォーム（Googleフォーム）
  - 利用規約
  - プライバシーポリシー
___

## 技術スタック
| カテゴリ | 技術 |
| ---- | ---- |
| フロントエンド | Rails 7.1.3, TailwindCSS, DaisyUI, JavaScript, Stimulus |
| バックエンド | Rails 7.1.3 (Ruby 3.2.3 ) |
| データベース | PostgreSQL |
| インフラ | Render.com, [Uptime Robot](https://uptimerobot.com/), AWS S3 |
| 認証 | [gem 'devise'](https://github.com/heartcombo/devise), [Omniauth](omniauth), Google認証 |
| 開発環境 | Docker |
| API | OpenAI |
| アナリティクス | [Google Analytics](https://developers.google.com/analytics?hl=ja) |

## [画面遷移図](https://www.figma.com/design/7i6BdzFdxvh2EU5cKqbr7q/%E3%81%82%E3%82%8B%E3%81%82%E3%82%8B%E7%A5%9E%E7%B5%8C%E8%A1%B0%E5%BC%B1%EF%BC%88%E6%9C%AC%E3%83%AA%E3%83%AA%E7%89%88%EF%BC%89?node-id=0-1&t=30LoFr3hdgxxuKdq-1)
[![Image from Gyazo](https://i.gyazo.com/370df50dcc8384335f46adf9ec1943cb.jpg)](https://gyazo.com/370df50dcc8384335f46adf9ec1943cb)
- [お問い合わせ](https://docs.google.com/forms/d/e/1FAIpQLSc7aPOWo9En9Ctwj0gOaXP418BtiicSvX2KXx5dLRnwWJRlIg/viewform)：Googleフォームに遷移します
- Xシェアボタン：Xに遷移し、ポストができます
- `遊んだみんなの感想をXで見る`ボタン：Xに遷移し、[#あるある神経衰弱](https://x.com/hashtag/%E3%81%82%E3%82%8B%E3%81%82%E3%82%8B%E7%A5%9E%E7%B5%8C%E8%A1%B0%E5%BC%B1?src=hashtag_click&f=live) がついたポストを見れます

## [ER図](https://dbdiagram.io/d/あるある神経衰弱-670531e2fb079c7ebdbde9aa)
[![Image from Gyazo](https://i.gyazo.com/b7c00230b096af7a39f110cb9d8b3192.png)](https://gyazo.com/b7c00230b096af7a39f110cb9d8b3192)
- あくまで投稿は`○○さんが思う△△あるある`という形で扱うため、`Posts`テーブルに`aruaru_one`~`aruaru_five`までを設けています
